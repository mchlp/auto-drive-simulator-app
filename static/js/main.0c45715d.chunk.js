(this["webpackJsonpauto-drive-network-app"]=this["webpackJsonpauto-drive-network-app"]||[]).push([[0],{121:function(e,t){},124:function(e,t,a){"use strict";a.r(t);var n,o=a(1),r=a.n(o),c=a(18),i=a.n(c),l=a(23),s=a(3),u=a(15),d=a(10),p=a(11),m=a(13),E=a(40),f=a.n(E),O=a(22),h=a(65),v={APP_MODE_LIST:{VIEW_MAP:"view_map",CREATE_MAP:"create_map"},COMPLETED_TRIP_VEHICLE_ID:"__trip_completed__",BUILD_ACTIONS:{ADD_LOCATION:"ADD_LOCATION",ADD_INTERSECTION:"ADD_INTERSECTION",BUILD_MAJOR_ROAD:"BUILD_MAJOR_ROAD",BUILD_MINOR_ROAD:"BUILD_MINOR_ROAD",BUILD_LOCAL_ROAD:"BUILD_LOCAL_ROAD",DELETE_COMPONENTS:"DELETE_COMPONENTS",RESET_POINTER:"RESET_POINTER",SAVE_MAP:"SAVE_MAP"},BUILD_POINTER_TYPE:{INTERSECTION:"intersection",LOCATION:"location",NONE:"none",ROAD_SUFFIX:"_road",MAJOR_ROAD:"major_road",MINOR_ROAD:"minor_road",LOCAL_ROAD:"local_road",DELETE:"delete"}},T="UPDATE_MAP_DATA_LOADED",D="UPDATE_AVERAGE_RENDERS_PER_SECOND",b="UPDATE_AVERAGE_UPDATES_PER_SECOND",y="UPDATE_CUR_MODE",I="UPDATE_CUR_BUILD_POINTER_TYPE",_="UPDATE_SELECTED_COMPONENT",S="UPDATE_HOVERED_COMPONENT",g="UPDATE_SHOW_DYNAMIC_LABELS",C="UPDATE_SHOW_STATIC_LABELS",A="UPDATE_SHOW_TOGGLE_DYNAMIC_LABELS",L="UPDATE_SHOW_FPS_WARNING",P="UPDATE_SHOW_ABOUT_MODAL",w="UPDATE_CUR_TRIP_VEHICLE_ID",R="UPDATE_FOLLOW_CUR_TRIP_VEHICLE",N="UPDATE_CANVAS_DIMENSIONS",M="UPDATE_CANVAS_PROPS_BY_DIFF",j="UPDATE_CANVAS_PROPS",k="UPDATE_CANVAS_PROPS_BY_ZOOM_FACTOR",U="UPDATE_CANVAS_OFFSET",Y={setCurBuildPointerType:function(e){return{type:I,payload:e}},setShowAboutModal:function(e){return{type:P,payload:e}},setFollowCurTripVehicle:function(e){return{type:R,payload:e}},setCanvasOffset:function(e){return{type:U,payload:e}},setCanvasPropsZoom:function(e,t){return{type:k,payload:{zoomOffsetFromViewCentre:t,zoomFactor:e}}},setCanvasPropsDiff:function(e){return{type:M,payload:e}},setCanvasProps:function(e){return{type:j,payload:e}},setCanvasDimensions:function(e){return{type:N,payload:e}},setCurMode:function(e){return{type:y,payload:e}},setSelectedComponent:function(e){return{type:_,payload:e}},setHoveredComponent:function(e){return{type:S,payload:e}},setShowDynamicLabels:function(e){return{type:g,payload:e}},setShowStaticLabels:function(e){return{type:C,payload:e}},setShowToggleDynamicLabels:function(e){return{type:A,payload:e}},setShowFpsWarning:function(e){return{type:L,payload:e}},setCurTripVehicleId:function(e){return{type:w,payload:e}},setMapDataLoaded:function(e){return{type:T,payload:e}},setAverageUpdatesPerSecond:function(e){return{type:b,payload:e}},setAverageRendersPerSecond:function(e){return{type:D,payload:e}}},B={mapDataLoaded:!1,averageUpdatesPerSecond:Number.POSITIVE_INFINITY,averageRendersPerSecond:Number.POSITIVE_INFINITY,curMode:v.APP_MODE_LIST.VIEW_MAP,curBuildPointerType:v.BUILD_POINTER_TYPE.NONE,selectedComponent:null,hoveredComponent:null,showLabels:{dynamic:!0,static:!0},curTripVehicleId:null,followCurTripVehicle:!1,showToggleDynamicLabels:!0,showLowFpsWarning:!1,shownLowFpsWarning:!1,showAboutModal:!0,canvasDimensions:{width:0,height:0},canvasProps:{centerX:0,centerY:0,zoom:.5},canvasOffset:{left:0,top:0}},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case I:return Object(s.a)(Object(s.a)({},e),{},{curBuildPointerType:t.payload});case P:return Object(s.a)(Object(s.a)({},e),{},{showAboutModal:t.payload});case R:return Object(s.a)(Object(s.a)({},e),{},{followCurTripVehicle:t.payload,canvasProps:Object(s.a)(Object(s.a)({},e.canvasProps),{},{zoom:t.payload?1:e.canvasProps.zoom})});case U:return Object(s.a)(Object(s.a)({},e),{},{canvasOffset:Object(s.a)(Object(s.a)({},e.canvasOffset),t.payload)});case D:return Object(s.a)(Object(s.a)({},e),{},{averageRendersPerSecond:t.payload});case b:return Object(s.a)(Object(s.a)({},e),{},{averageUpdatesPerSecond:t.payload});case T:return Object(s.a)(Object(s.a)({},e),{},{mapDataLoaded:t.payload});case k:var a=t.payload,n=a.zoomOffsetFromViewCentre,o=a.zoomFactor,r={x:n.x+e.canvasProps.centerX,y:n.y+e.canvasProps.centerY};return Object(s.a)(Object(s.a)({},e),{},{canvasProps:{centerX:e.canvasProps.centerX-r.x*(1-o),centerY:e.canvasProps.centerY-r.y*(1-o),zoom:e.canvasProps.zoom*o}});case M:return Object(s.a)(Object(s.a)({},e),{},{canvasProps:{centerX:t.payload.centerX?e.canvasProps.centerX+t.payload.centerX:e.canvasProps.centerX,centerY:t.payload.centerY?e.canvasProps.centerY+t.payload.centerY:e.canvasProps.centerY,zoom:t.payload.zoom?e.canvasProps.zoom*t.payload.zoom:e.canvasProps.zoom}});case j:return Object(s.a)(Object(s.a)({},e),{},{canvasProps:Object(s.a)(Object(s.a)({},e.canvasProps),t.payload)});case N:return Object(s.a)(Object(s.a)({},e),{},{canvasDimensions:Object(s.a)(Object(s.a)({},e.canvasDimensions),t.payload)});case y:return Object(s.a)(Object(s.a)({},e),{},{curMode:t.payload,selectedComponent:null,hoveredComponent:null,mapDataLoaded:t.payload===v.APP_MODE_LIST.CREATE_MAP});case _:return Object(s.a)(Object(s.a)({},e),{},{selectedComponent:t.payload});case S:return Object(s.a)(Object(s.a)({},e),{},{hoveredComponent:t.payload});case g:return Object(s.a)(Object(s.a)({},e),{},{showLabels:Object(s.a)(Object(s.a)({},e.showLabels),{},{dynamic:t.payload})});case C:return Object(s.a)(Object(s.a)({},e),{},{showLabels:Object(s.a)(Object(s.a)({},e.showLabels),{},{static:t.payload})});case A:return Object(s.a)(Object(s.a)({},e),{},{showToggleDynamicLabels:t.payload});case L:return t.payload&&!e.shownLowFpsWarning?Object(s.a)(Object(s.a)({},e),{},{showLowFpsWarning:!0,shownLowFpsWarning:!0}):Object(s.a)(Object(s.a)({},e),{},{showLowFpsWarning:!1});case w:return Object(s.a)(Object(s.a)({},e),{},{curTripVehicleId:t.payload});default:return e}},x=a(66);function F(){return n}var W=function(){function e(){Object(d.a)(this,e)}return Object(p.a)(e,null,[{key:"generateShortUuid",value:function(){return this.shortUuidGenerator.generate()}},{key:"getCanvasViewCutoffs",value:function(){var e=F().getState().canvasDimensions;return{left:0,right:e.width,top:0,bottom:e.height}}},{key:"checkCoordinateInCanvasView",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=this.getCanvasViewCutoffs(),n=e[0]+t/2>=a.left,o=e[0]-t/2<=a.right,r=e[1]+t/2>=a.top,c=e[1]-t/2<=a.bottom;return n&&o&&r&&c}},{key:"getCoordFromWaypoint",value:function(e,t){return e.startsWith("intersection")?t.intersections[e].coord:e.startsWith("location")?t.locations[e].coord:null}},{key:"getDistanceBetweenArrayCoords",value:function(e,t){for(var a=0,n=0;n<e.length;n++)a+=Math.pow(t[n]-e[n],2);return Math.sqrt(a)}},{key:"mapArrayCoord",value:function(t){return t?t.map(e.mapSingleCoord):null}},{key:"unmapArrayCoord",value:function(t){return t?t.map(e.unmapSingleCoord):null}},{key:"scaleSingleCoord",value:function(e){return e*F().getState().canvasProps.zoom}},{key:"unscaleSingleCoord",value:function(e){return e/F().getState().canvasProps.zoom}},{key:"mapSingleCoord",value:function(t,a){var n=e.scaleSingleCoord(t),o=F().getState(),r=o.canvasDimensions,c=o.canvasProps;return 0===a?n+=r.width/2-c.centerX:1===a&&(n+=r.height/2-c.centerY),n}},{key:"unmapSingleCoord",value:function(t,a){var n=t,o=F().getState(),r=o.canvasDimensions,c=o.canvasProps;return 0===a?n-=r.width/2-c.centerX:1===a&&(n-=r.height/2-c.centerY),e.unscaleSingleCoord(n)}}]),e}();W.shortUuidGenerator=f()(f.a.constants.flickrBase58);var z=a(32),H={ROAD_DRIVING_SIDE:{LEFT:"left",RIGHT:"right"},VEHICLE_STATE:{SPAWNED:"spawned",DEPARTURE_READY:"departure_ready",EN_ROUTE:"en_route",ARRIVED:"arrived"},ROAD_TYPES:{TYPES:{LOCAL:"LOCAL",MINOR:"MINOR",MAJOR:"MAJOR"},WIDTH:{LOCAL:50,MINOR:60,MAJOR:100}},VEHICLE_DIRECTION:{TOWARDS_START:"towards_start",TOWARDS_END:"towards_end"},DISPLAY:{INTERSECTION_RADIUS:45,LOCATION_RADIUS:30,VEHICLE_RADIUS:10}},J={dictionaries:[z.b,z.a,["House","Cottage","Barn","Townhouse","Apartment","Condo","Bungalow","Shop","Mall","Hotel","Cinema","Warehouse","Office","Laboratory","Museum","Library","Gym"]],separator:"_",style:"capital"};H.getUniqueLocationName=function(){var e=Object(z.c)(J).split("_");return e[0]+="'s",e.join(" ")};var X=H,G=function(){function e(){Object(d.a)(this,e)}return Object(p.a)(e,null,[{key:"render",value:function(e,t,a){var n=function(a){Object.entries(t.roads).forEach((function(n){n[0];var o=n[1],r=W.mapArrayCoord(W.getCoordFromWaypoint(o.start,t)),c=W.mapArrayCoord(W.getCoordFromWaypoint(o.end,t));if(r&&c)if("pavement"===a)o.type===X.ROAD_TYPES.TYPES.LOCAL?e.lineWidth=W.scaleSingleCoord(X.ROAD_TYPES.WIDTH.LOCAL):o.type===X.ROAD_TYPES.TYPES.MINOR?e.lineWidth=W.scaleSingleCoord(X.ROAD_TYPES.WIDTH.MINOR):o.type===X.ROAD_TYPES.TYPES.MAJOR&&(e.lineWidth=W.scaleSingleCoord(X.ROAD_TYPES.WIDTH.MAJOR)),e.strokeStyle="black",e.lineJoin="round",e.setLineDash([]),e.beginPath(),e.moveTo.apply(e,Object(m.a)(r)),e.lineTo.apply(e,Object(m.a)(c)),e.stroke();else if("center-line"===a){if(e.lineWidth=W.scaleSingleCoord(1),e.strokeStyle="yellow",o.type===X.ROAD_TYPES.TYPES.LOCAL)e.setLineDash([W.scaleSingleCoord(5),W.scaleSingleCoord(5)]),e.beginPath(),e.moveTo.apply(e,Object(m.a)(r)),e.lineTo.apply(e,Object(m.a)(c)),e.stroke();else if(o.type===X.ROAD_TYPES.TYPES.MINOR)e.setLineDash([]),e.beginPath(),e.moveTo.apply(e,Object(m.a)(r)),e.lineTo.apply(e,Object(m.a)(c)),e.stroke();else if(o.type===X.ROAD_TYPES.TYPES.MAJOR){e.setLineDash([]),e.beginPath(),e.moveTo.apply(e,Object(m.a)(r)),e.lineTo.apply(e,Object(m.a)(c)),e.stroke();var i={x:c[0]-r[0],y:c[1]-r[1]},l={x:-i.y/Math.sqrt(Math.pow(i.x,2)+Math.pow(i.y,2)),y:i.x/Math.sqrt(Math.pow(i.x,2)+Math.pow(i.y,2))};e.strokeStyle="white",e.setLineDash([W.scaleSingleCoord(3),W.scaleSingleCoord(5)]),e.beginPath(),e.moveTo(r[0]+W.scaleSingleCoord(25*l.x),r[1]+W.scaleSingleCoord(25*l.y)),e.lineTo(c[0]+W.scaleSingleCoord(25*l.x),c[1]+W.scaleSingleCoord(25*l.y)),e.stroke(),e.beginPath(),e.moveTo(r[0]-W.scaleSingleCoord(25*l.x),r[1]-W.scaleSingleCoord(25*l.y)),e.lineTo(c[0]-W.scaleSingleCoord(25*l.x),c[1]-W.scaleSingleCoord(25*l.y)),e.stroke()}e.lineJoin="round"}}))};n("pavement"),n("center-line")}}]),e}(),q=function(){function e(){Object(d.a)(this,e)}return Object(p.a)(e,null,[{key:"render",value:function(e,t,a){Object.entries(t.locations).forEach((function(t){t[0];var n=t[1],o=W.mapArrayCoord(n.coord);W.checkCoordinateInCanvasView(o,X.DISPLAY.LOCATION_RADIUS)&&(e.lineWidth=2,e.strokeStyle="grey",e.fillStyle="#ff0000",e.setLineDash([]),e.beginPath(),e.arc(o[0],o[1],W.scaleSingleCoord(X.DISPLAY.LOCATION_RADIUS),0,2*Math.PI),e.stroke(),e.fill(),a&&(e.font=W.scaleSingleCoord(25)+"px Roboto",e.strokeStyle="white",e.strokeWidth=W.scaleSingleCoord(2),e.strokeText(n.name,o[0],o[1]),e.fillStyle="black",e.fillText(n.name,o[0],o[1])))}))}}]),e}(),Z=function(){function e(){Object(d.a)(this,e)}return Object(p.a)(e,null,[{key:"render",value:function(e,t,a){Object.entries(t.intersections).forEach((function(t){var n=t[0],o=t[1],r=W.mapArrayCoord(o.coord);W.checkCoordinateInCanvasView(r,X.DISPLAY.INTERSECTION_RADIUS)&&(e.lineWidth=2,e.strokeStyle="grey",e.fillStyle="black",e.setLineDash([]),e.beginPath(),e.arc(r[0],r[1],W.scaleSingleCoord(X.DISPLAY.INTERSECTION_RADIUS),0,2*Math.PI),e.fill(),a&&(e.font=W.scaleSingleCoord(50)+"px Roboto",e.strokeStyle="white",e.strokeWidth=W.scaleSingleCoord(2),e.strokeText(n,r[0],r[1]),e.fillStyle="black",e.fillText(n,r[0],r[1])))}))}}]),e}(),K=function(){function e(){Object(d.a)(this,e)}return Object(p.a)(e,null,[{key:"render",value:function(e,t,a,n){Object.entries(t.vehicles).forEach((function(t){var o=t[0],r=t[1],c=W.mapArrayCoord(r.coord);if(W.checkCoordinateInCanvasView(c,X.DISPLAY.VEHICLE_RADIUS)&&(e.lineWidth=2,e.strokeStyle="grey",e.fillStyle=n===o?"purple":"blue",e.setLineDash([]),e.beginPath(),e.arc(c[0],c[1],W.scaleSingleCoord(X.DISPLAY.VEHICLE_RADIUS),0,2*Math.PI),e.stroke(),e.fill(),a||n===o)){e.lineJoin="round",e.miterLimit=2;var i="".concat(o," | Src: ").concat(r.origin.name," | Dest: ").concat(r.destination.name);e.font=W.scaleSingleCoord(15)+"px Roboto",e.strokeStyle="black",e.strokeWidth=W.scaleSingleCoord(1),e.strokeText(i,c[0],c[1]),e.fillStyle="yellow",e.fillText(i,c[0],c[1])}}))}}]),e}(),Q={mapData:null,lastUpdateTimeElapsedList:[]};Q.lastUpdateTime=performance.now(),Q.lastReduxUpdateTime=performance.now();var $=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if((t||F().getState().curMode===v.APP_MODE_LIST.VIEW_MAP)&&(Q.mapData=e),F().getState().mapDataLoaded||F().dispatch(Y.setMapDataLoaded(!0)),F().getState().followCurTripVehicle){var a=F().getState().curTripVehicleId;if(Q.mapData.vehicles[a]){var n=Q.mapData.vehicles[a].coord;F().dispatch(Y.setCanvasProps({centerX:W.scaleSingleCoord(n[0]),centerY:W.scaleSingleCoord(n[1])}))}else F().dispatch(Y.setFollowCurTripVehicle(!1)),F().dispatch(Y.setCurTripVehicleId(v.COMPLETED_TRIP_VEHICLE_ID))}var o=performance.now(),r=o-Q.lastUpdateTime;if(Q.lastUpdateTimeElapsedList.push(r),Q.lastUpdateTimeElapsedList.length>100&&Q.lastUpdateTimeElapsedList.shift(),o-Q.lastReduxUpdateTime>1e3){var c=Q.lastUpdateTimeElapsedList.reduce((function(e,t){return e+t}),0)/Q.lastUpdateTimeElapsedList.length,i=1e3/c;Q.lastUpdateTimeElapsedList.length<100&&(i=Number.POSITIVE_INFINITY),F().dispatch(Y.setAverageUpdatesPerSecond(i)),Q.lastReduxUpdateTime=o}Q.lastUpdateTime=o};Q.init=function(e){e.on("update-map-data",$)},Q.cleanup=function(e){e.off("update-map-data",$)},Q.updateMapData=function(e){$(e,!0)};var ee=Q,te=function(){function e(){Object(d.a)(this,e)}return Object(p.a)(e,null,[{key:"getMapData",value:function(){return ee.mapData}},{key:"getShowLabels",value:function(){var e=F().getState(),t=e.showToggleDynamicLabels,a=e.followCurTripVehicle,n=e.showLabels.dynamic;return t&&n&&!a}},{key:"getCurTripVehicleId",value:function(){return F().getState().curTripVehicleId}},{key:"_renderStatic",value:function(e){var t=this.getMapData(),a=this.getShowLabels(),n=F().getState().canvasDimensions,o=n.width,r=n.height;if(t&&e){var c=e.getContext("2d");c.clearRect(0,0,o,r),c.fillStyle="#dddddd",c.fillRect(0,0,o,r),G.render(c,t,a),q.render(c,t,!0),Z.render(c,t,!1)}}},{key:"_renderDynamic",value:function(e){var t=this.getMapData(),a=this.getShowLabels(),n=F().getState().canvasDimensions,o=n.width,r=n.height;if(t&&e){var c=e.getContext("2d");c.clearRect(0,0,o,r),K.render(c,t,a,this.getCurTripVehicleId())}}},{key:"renderAll",value:function(e,t){this._renderStatic(e),this._renderDynamic(t);var a=performance.now(),n=a-this.lastRenderTime;if(this.lastRenderTimeElapsedList.push(n),this.lastRenderTimeElapsedList.length>100&&this.lastRenderTimeElapsedList.shift(),a-this.lastReduxUpdateTime>1e3){var o=1e3/(this.lastRenderTimeElapsedList.reduce((function(e,t){return e+t}),0)/this.lastRenderTimeElapsedList.length);this.lastRenderTimeElapsedList.length<100&&(o=Number.POSITIVE_INFINITY),F().dispatch(Y.setAverageRendersPerSecond(o)),this.lastReduxUpdateTime=a}this.lastRenderTime=a}}]),e}();te.lastRenderTimeElapsedList=[],te.lastRenderTime=performance.now(),te.lastReduxUpdateTime=performance.now();var ae=a(8),ne=a(125);var oe=Object(ae.b)((function(e){return{curMode:e.curMode,mapLoaded:e.mapDataLoaded,showDynamicLabels:e.showLabels.dynamic,showToggleDynamicLabels:e.showToggleDynamicLabels,canvasProps:e.canvasProps,canvasDimensions:e.canvasDimensions,followCurTripVehicle:e.followCurTripVehicle}}))((function(e){var t=e.showToggleDynamicLabels,a=e.dispatch,n=e.canvasProps,c=e.canvasDimensions,i=e.mapLoaded,l=e.followCurTripVehicle,s=Object(o.useRef)(null),u=Object(o.useRef)(null),d=Object(o.useRef)(null);Object(o.useEffect)((function(){a(Y.setCanvasProps({centerX:0,centerY:0,zoom:.5}));var e=function(){a(Y.setCanvasDimensions({height:window.innerHeight,width:window.innerWidth}))};return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[a]);var p=Object(o.useRef)(!1),m=Object(o.useRef)(null);Object(o.useEffect)((function(){var e=function(e){var t=0,n=0;switch(e.key){case"ArrowUp":n=50;break;case"ArrowDown":n=-50;break;case"ArrowLeft":t=50;break;case"ArrowRight":t=-50}a(Y.setCanvasPropsDiff({centerX:t,centerY:n,zoom:1}))};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}),[a]);var E=Object(o.useCallback)((function(e){if(e.preventDefault(),e.stopPropagation(),i){var t=e.pageX,n=e.pageY,o=e.deltaY,r=1;if(o>0?r=.8:o<0&&(r=1.25),l)a(Y.setCanvasPropsZoom(r,{x:0,y:0}));else{var u={x:t-s.current.offsetLeft,y:n-s.current.offsetTop},d={x:u.x-c.width/2,y:u.y-c.height/2};a(Y.setCanvasPropsZoom(r,d))}}return!1}),[c,a,i,l]);Object(o.useEffect)((function(){if(d.current){a(Y.setCanvasOffset({left:d.current.offsetLeft,top:d.current.offsetTop}));var e=d.current;return e.addEventListener("wheel",E,{passive:!1}),function(){e.removeEventListener("wheel",E)}}}),[d,i,a,E]);var f=Object(o.useRef)(null);Object(o.useEffect)((function(){return f.current=window.requestAnimationFrame((function e(){te.renderAll(s.current,u.current),f.current=window.requestAnimationFrame(e)})),function(){window.cancelAnimationFrame(f.current)}}),[]);var O=function(e){p.current=!1,m.current=null},h=Object(o.useRef)(null);return Object(o.useEffect)((function(){n.zoom<.4?t&&a(Y.setShowToggleDynamicLabels(!1)):t||a(Y.setShowToggleDynamicLabels(!0))}),[n.zoom,t,a]),r.a.createElement("div",{onMouseDown:function(e){e.preventDefault(),i&&!l&&(p.current=!0,m.current={x:e.screenX,y:e.screenY})},onMouseUp:O,onMouseLeave:O,onMouseMove:function(e){var t=performance.now();if(p.current&&(!h.current||t-h.current>1e3/30)){h.current=t;var n={x:m.current.x,y:m.current.y},o={x:e.screenX,y:e.screenY};a(Y.setCanvasPropsDiff({zoom:1,centerX:-(o.x-n.x),centerY:-(o.y-n.y)})),m.current=o}},ref:d,style:{height:c.height,width:c.width,position:"absolute",top:0,left:0,zIndex:-1,overflow:"hidden"}},i?r.a.createElement("div",null,r.a.createElement("canvas",{style:{position:"absolute",zIndex:2},ref:u,height:c.height,width:c.width}),r.a.createElement("canvas",{style:{position:"absolute",zIndex:1},ref:s,height:c.height,width:c.width})):r.a.createElement("div",{style:{backgroundColor:"#dddddd",height:"100%",width:"100%",display:"flex",alignContent:"center",alignItems:"center",justifyContent:"center"}},r.a.createElement("div",{style:{display:"flex",alignContent:"center",alignItems:"center",justifyContent:"center",flexDirection:"column"}},r.a.createElement("div",{className:"mb-2"},r.a.createElement(ne.a,{type:"grow",color:"primary",size:"m"})),r.a.createElement("div",null,"Conneting to server..."),r.a.createElement("div",null,"This may take a minute while the server starts."))))})),re={},ce=function(e,t,a,n){for(var o=0,r=Object.entries(t.intersections);o<r.length;o++){var c=r[o];if(!n.includes(c[0])){var i=c[1];if(W.getDistanceBetweenArrayCoords(i.coord,e)<X.DISPLAY.INTERSECTION_RADIUS+a)return{type:"intersection",id:c[0],data:c[1]}}}return null},ie=function(e,t,a,n){for(var o=0,r=Object.entries(t.locations);o<r.length;o++){var c=r[o];if(!n.includes(c[0])){var i=c[1];if(W.getDistanceBetweenArrayCoords(i.coord,e)<X.DISPLAY.LOCATION_RADIUS+a)return{type:"location",id:c[0],data:c[1]}}}return null};re.findComponent=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=ee.mapData,o=[ce,ie],r=0,c=o;r<c.length;r++){var i=c[r],l=i(e,n,t,a);if(l)return l}};var le=re,se=a(134),ue=a(126),de=a(127),pe=a(128),me=a(129);function Ee(e){var t=e.isOpen,a=e.setIsOpen;return r.a.createElement(se.a,{isOpen:t,toggle:function(){a(!t)}},r.a.createElement(ue.a,{toggle:function(){a(!t)}},"Low FPS Detected"),r.a.createElement(de.a,null,"It has been detected at the map is running at a lower than optimal frame rate. It may help to hide the labels by toggling the ",r.a.createElement("code",null,"Toggle Labels")," checkbox"),r.a.createElement(pe.a,null,r.a.createElement(me.a,{color:"primary",onClick:function(){a(!t)}},"OK")))}var fe=a(43);function Oe(e){var t,a=e.sectionName,n=e.children,c=e.openInitial,i=void 0===c||c,l=Object(o.useState)(i),s=Object(u.a)(l,2),d=s[0],p=s[1];return t=d?fe.a:fe.b,r.a.createElement("div",{className:"mx-2 my-1"},r.a.createElement("div",{className:"font-weight-bold",style:{display:"flex",justifyContent:"space-between",alignContent:"center",alignItems:"center"}},a,r.a.createElement("div",{style:{cursor:"pointer"},onClick:function(){p((function(e){return!e}))}},r.a.createElement(t,null))),d&&r.a.createElement("div",null,n),r.a.createElement("hr",{className:"mb-0"}))}var he=a(30),ve=a(130),Te=a(131);var De=Object(ae.b)((function(e){return{selectedComponent:e.selectedComponent,hoveredComponent:e.hoveredComponent}}))((function(e){var t,a=e.hoveredComponent,n=e.selectedComponent,c=e.updateLocationName,i=Object(o.useState)(!1),l=Object(u.a)(i,2),s=l[0],d=l[1],p=Object(o.useState)(""),m=Object(u.a)(p,2),E=m[0],f=m[1],O=a||n;return t=O?r.a.createElement("div",null,r.a.createElement("div",null,"Type: ",O.type),"location"===O.type&&r.a.createElement("div",null,"Name:"," ",s&&c?r.a.createElement(ve.a,{inline:!0,onSubmit:function(e){return e.preventDefault(),c(O.id,E),d(!1),!1}},r.a.createElement(Te.a,{style:{fontSize:12},className:"my-1",type:"text",name:"component-name",autoFocus:!0,onBlur:function(){c(O.id,E),d(!1)},onChange:function(e){f(e.target.value)},value:E})):O.data.name?O.data.name:r.a.createElement("span",{style:{color:"grey"}},"No name set"),!s&&c&&r.a.createElement(he.a,{className:"ml-2",style:{cursor:"pointer"},onClick:function(){f(O.data.name),d(!0)}})),r.a.createElement("div",null,"Coordiantes: [",O.data.coord[0].toFixed(3),","," ",O.data.coord[1].toFixed(3),"]")):r.a.createElement("div",null,"No component selected"),r.a.createElement("div",{style:{fontSize:12}},t)})),be=a(132),ye=a(133);var Ie=Object(ae.b)((function(e){return{mapDataLoaded:e.mapDataLoaded,curTripVehicleId:e.curTripVehicleId,followCurTripVehicle:e.followCurTripVehicle,curMode:e.curMode}}))((function(e){var t=e.curMode,a=e.curTripVehicleId,n=e.mapDataLoaded,c=e.socket,i=e.followCurTripVehicle,l=e.dispatch,s=Object(o.useState)(null),d=Object(u.a)(s,2),p=d[0],m=d[1];Object(o.useEffect)((function(){a&&a!==v.COMPLETED_TRIP_VEHICLE_ID&&m(ee.mapData.vehicles[a])}),[]),Object(o.useEffect)((function(){if(c){var e=function(e){e&&(m(e),l(Y.setCurTripVehicleId(e.id)),l(Y.setFollowCurTripVehicle(!0)))};return c.on("start-trip-res",e),function(){c.off("start-trip-res",e)}}}),[c,l]);var E=n?Object.values(ee.mapData.locations):[];E.sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}));var f,O={fontSize:10};return f=t===v.APP_MODE_LIST.CREATE_MAP?r.a.createElement("div",null,"Starting a trip is not allowed when building a map. Switch to View Mode to start a trip."):a&&a!==v.COMPLETED_TRIP_VEHICLE_ID&&p?r.a.createElement("div",{style:{fontSize:12}},r.a.createElement("div",null,r.a.createElement("span",{className:"font-weight-bold"},"Vehicle ID: "),a),r.a.createElement("div",null,r.a.createElement("span",{className:"font-weight-bold"},"Origin: "),p.origin.name),r.a.createElement("div",null,r.a.createElement("span",{className:"font-weight-bold"},"Destination: "),p.destination.name),r.a.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",alignContent:"center"},className:"my-1"},r.a.createElement("input",{type:"checkbox",id:"follow-cur-trip-chkbox",className:"mr-1",checked:i,onChange:function(e){var t=e.target.checked;l(Y.setFollowCurTripVehicle(t))}}),r.a.createElement("label",{htmlFor:"follow-cur-trip-chkbox",className:"m-0",style:{userSelect:"none",fontSize:10}},"Toggle Follow Current Trip Vehicle")),r.a.createElement(me.a,{className:"mt-2",color:"primary",style:{fontSize:10},onClick:function(){m(null),l(Y.setCurTripVehicleId(null)),l(Y.setFollowCurTripVehicle(!1))}},"Start a New Trip")):r.a.createElement("div",{style:{fontSize:10}},r.a.createElement("div",null,a===v.COMPLETED_TRIP_VEHICLE_ID&&r.a.createElement(be.a,{className:"mb-1 mt-2 p-2",color:"success"},r.a.createElement("div",{className:"font-weight-bold"},"You have reached your destination!"),"You can start a new trip below."),r.a.createElement(ye.a,{for:"navigate-origin",className:"font-weight-bold mb-1 mt-1"},"Origin"),r.a.createElement(Te.a,{style:O,type:"select",name:"select",id:"navigate-origin"},E.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id,style:O},e.name)})))),r.a.createElement("div",null,r.a.createElement(ye.a,{for:"navigate-dest",className:"font-weight-bold mb-1 mt-2"},"Destination"),r.a.createElement(Te.a,{style:O,type:"select",name:"select",id:"navigate-dest"},E.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id,style:O},e.name)})))),r.a.createElement(me.a,{className:"mt-2",color:"primary",style:{fontSize:10},onClick:function(){var e,t;e=document.getElementById("navigate-origin").value,t=document.getElementById("navigate-dest").value,c&&c.emit("start-trip",{originId:e,destinationId:t})}},"Navigate")),r.a.createElement("div",null,r.a.createElement("div",{className:"mb-1"},a?"Trip Progress":"Start a Trip"),f)}));var _e=Object(ae.b)((function(e){return{showToggleDynamicLabels:e.showToggleDynamicLabels,curMode:e.curMode,showDynamicLabels:e.showLabels.dynamic,followCurTripVehicle:e.followCurTripVehicle}}))((function(e){var t=e.curMode,a=e.showToggleDynamicLabels,n=e.showDynamicLabels,o=e.followCurTripVehicle,c=e.dispatch;return r.a.createElement("div",null,a&&!o&&t===v.APP_MODE_LIST.VIEW_MAP&&r.a.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",alignContent:"center"},className:"my-1"},r.a.createElement("input",{type:"checkbox",id:"show-labels-chkbox",className:"mr-1",checked:n,onChange:function(e){var t=e.target.checked;c(Y.setShowDynamicLabels(t))}}),r.a.createElement("label",{htmlFor:"show-labels-chkbox",className:"m-0",style:{userSelect:"none",fontSize:10}},"Show Vehicle Labels")),r.a.createElement("div",null,r.a.createElement(me.a,{color:"link",style:{fontSize:10,padding:0},onClick:function(){t===v.APP_MODE_LIST.CREATE_MAP?c(Y.setCurMode(v.APP_MODE_LIST.VIEW_MAP)):c(Y.setCurMode(v.APP_MODE_LIST.CREATE_MAP))}},t===v.APP_MODE_LIST.CREATE_MAP?"Switch to View Mode":"Switch to Create Mode")))}));var Se=Object(ae.b)((function(e){return{averageUpdatesPerSecond:e.averageUpdatesPerSecond,averageRendersPerSecond:e.averageRendersPerSecond,mapDataLoaded:e.mapDataLoaded,curMode:e.curMode}}))((function(e){var t,a=e.mapDataLoaded,n=e.averageUpdatesPerSecond,o=e.averageRendersPerSecond,c=e.curMode,i={};if(a){var l=ee.mapData;t=r.a.createElement("div",null,r.a.createElement("div",{style:i},"Map ID: ",l.id),r.a.createElement("div",{style:i},"Total Vehicles: ",Object.keys(l.vehicles).length),r.a.createElement("div",{style:i},"Total Intersections:"," ",Object.keys(l.intersections).length),r.a.createElement("div",{style:i},"Total Locations: ",Object.keys(l.locations).length),r.a.createElement("div",{style:i},"Total Roads: ",Object.keys(l.roads).length),c===v.APP_MODE_LIST.VIEW_MAP&&r.a.createElement("div",{style:i},"Avg Updates/Sec: ",n.toFixed(2)),r.a.createElement("div",{style:i},"Avg Renders/Sec: ",o.toFixed(2)))}else t=r.a.createElement("div",null,"Map data not loaded.");return r.a.createElement("div",{style:{fontSize:12}},t)}));var ge=Object(ae.b)((function(e){return{curBuildPointerType:e.curBuildPointerType}}))((function(e){var t,a=e.buildActionHandler,n=e.curBuildPointerType,o={fontSize:10},c=v.BUILD_POINTER_TYPE;switch(n){case c.LOCATION:t=r.a.createElement("div",null,r.a.createElement("div",{className:"font-weight-bold"},"You are currently adding a location."),"Left-click to put down a location.",r.a.createElement("br",null),"Right-click to cancel.");break;case c.INTERSECTION:t=r.a.createElement("div",null,r.a.createElement("div",{className:"font-weight-bold"},"You are currently adding an intersection."),"Left-click to put down a intersection.",r.a.createElement("br",null),"Right-click to cancel.");break;case c.MAJOR_ROAD:t=r.a.createElement("div",null,r.a.createElement("div",{className:"font-weight-bold"},"You are currently building major road."),"Start by left-clicking on a location or intersection to mark the starting point.",r.a.createElement("br",null),"After, left-click on another location or intersection to mark the endpoint point.",r.a.createElement("br",null),"Continue left-clicking on locations or intersections to extend the road.",r.a.createElement("br",null),"Right-click to cancel.");break;case c.MINOR_ROAD:t=r.a.createElement("div",null,r.a.createElement("div",{className:"font-weight-bold"},"You are currently building minor road."),"Start by left-clicking on a location or intersection to mark the starting point.",r.a.createElement("br",null),"After, left-click on another location or intersection to mark the endpoint point.",r.a.createElement("br",null),"Continue left-clicking on locations or intersections to extend the road.",r.a.createElement("br",null),"Right-click to cancel.");break;case c.LOCAL_ROAD:t=r.a.createElement("div",null,r.a.createElement("div",{className:"font-weight-bold"},"You are currently building local road."),"Start by left-clicking on a location or intersection to mark the starting point.",r.a.createElement("br",null),"After, left-click on another location or intersection to mark the endpoint point.",r.a.createElement("br",null),"Continue left-clicking on locations or intersections to extend the road.",r.a.createElement("br",null),"Right-click to cancel.");break;case c.DELETE:t=r.a.createElement("div",null,r.a.createElement("div",{className:"font-weight-bold"},"You are currently deleting components."),"Left-click on a location or intersection to delete it. All connected roads will be deleted as well.",r.a.createElement("br",null),"Right-click to cancel.");break;default:t=r.a.createElement("div",null,r.a.createElement("div",{className:"font-weight-bold"},"Select one of the grey buttons below to start building!"),"Click on the help button on the top right for details.")}return r.a.createElement("div",null,r.a.createElement("div",{style:{fontSize:10}},r.a.createElement(be.a,{className:"mb-1 mt-2 p-2",color:"info"},t),r.a.createElement(me.a,{outline:!0,color:"secondary",className:"m-1",style:o,onClick:function(){a(v.BUILD_ACTIONS.ADD_LOCATION)}},"Add Location"),r.a.createElement(me.a,{outline:!0,color:"secondary",style:o,onClick:function(){a(v.BUILD_ACTIONS.ADD_INTERSECTION)},className:"m-1"},"Add Intersection"),r.a.createElement(me.a,{outline:!0,color:"secondary",style:o,onClick:function(){a(v.BUILD_ACTIONS.BUILD_MAJOR_ROAD)},className:"m-1"},"Build Major Road"),r.a.createElement(me.a,{outline:!0,color:"secondary",style:o,onClick:function(){a(v.BUILD_ACTIONS.BUILD_MINOR_ROAD)},className:"m-1"},"Build Minor Road"),r.a.createElement(me.a,{outline:!0,color:"secondary",style:o,onClick:function(){a(v.BUILD_ACTIONS.BUILD_LOCAL_ROAD)},className:"m-1"},"Build Local Road"),r.a.createElement(me.a,{outline:!0,color:"danger",style:o,onClick:function(){a(v.BUILD_ACTIONS.DELETE_COMPONENTS)},className:"m-1"},"Delete Components"),r.a.createElement(me.a,{outline:!0,color:"info",style:o,onClick:function(){a(v.BUILD_ACTIONS.RESET_POINTER)},className:"m-1"},"Reset Pointer"),r.a.createElement(me.a,{outline:!0,color:"success",style:o,onClick:function(){a(v.BUILD_ACTIONS.SAVE_MAP)},className:"m-1"},"Save Map")))}));var Ce=Object(ae.b)((function(e){return{curMode:e.curMode,mapDataLoaded:e.mapDataLoaded}}))((function(e){var t=e.socket,a=e.curMode,n=e.buildActionHandler,o=e.updateLocationName;return e.mapDataLoaded?r.a.createElement("div",{style:{background:"#ffffffcc",margin:10,display:"flex",flexDirection:"column",flexWrap:"wrap",justifyContent:"space-between",width:300,position:"fixed",borderRadius:5}},r.a.createElement(Oe,{sectionName:"Selected Component"},r.a.createElement(De,{updateLocationName:o})),r.a.createElement(Oe,{sectionName:a===v.APP_MODE_LIST.CREATE_MAP?"Build Controls":"Navigator"},a===v.APP_MODE_LIST.VIEW_MAP?r.a.createElement(Ie,{socket:t}):r.a.createElement(ge,{buildActionHandler:n})),r.a.createElement(Oe,{sectionName:"Map Stats"},r.a.createElement(Se,null)),r.a.createElement(Oe,{sectionName:"Map Settings"},r.a.createElement(_e,null))):null}));var Ae=Object(ae.b)((function(e){return{showAboutModal:e.showAboutModal}}))((function(e){var t=e.showAboutModal,a=e.dispatch,n=function(e){a(Y.setShowAboutModal(e))},o=t,c=r.a.createElement(se.a,{isOpen:o,toggle:function(){n(!o)}},r.a.createElement(ue.a,{toggle:function(){n(!o)}},r.a.createElement("img",{src:"/auto-drive-simulator-app/logo512.png",alt:"App logo",height:30,className:"mr-3"}),"About Auto Drive Simulator"),r.a.createElement(de.a,null,r.a.createElement("div",null,r.a.createElement("div",{style:{fontSize:12,color:"grey"}},"A web app to simulate a city of fully autonmous driving vehicles."),r.a.createElement("hr",null),r.a.createElement("div",{style:{fontSize:8}},"Icons made by"," ",r.a.createElement("a",{href:"https://www.flaticon.com/authors/freepik",title:"Freepik"},"Freepik")," ","from"," ",r.a.createElement("a",{href:"https://www.flaticon.com/",title:"Flaticon"},"www.flaticon.com")))));return r.a.createElement("div",null,t?c:r.a.createElement("div",{style:{margin:5,position:"fixed",right:0,top:0,cursor:"pointer"},onClick:function(){n(!0)}},r.a.createElement(he.b,{size:25})))}));var Le=Object(ae.b)((function(e){return{mapDataLoaded:e.mapDataLoaded,averageUpdatesPerSecond:e.averageUpdatesPerSecond,selectedComponent:e.selectedComponent,hoveredComponent:e.hoveredComponent,showDynamicLabels:e.showLabels.dynamic,showAboutModal:e.showAboutModal,showLowFpsWarning:e.showLowFpsWarning,canvasOffset:e.canvasOffset}}))((function(e){var t=e.onMouseMove,a=e.onMouseDown,n=e.curPointerRadius,c=e.curPointerComponentId,i=e.cursorStyle,l=e.socket,s=e.averageUpdatesPerSecond,u=e.selectedComponent,d=e.hoveredComponent,p=e.dispatch,m=e.showDynamicLabels,E=e.showLowFpsWarning,f=e.mapDataLoaded,O=e.canvasOffset,h=e.buildActionHandler,v=e.updateLocationName,T=Object(o.useRef)(null),D=function(e){var t=e.pageX,a=e.pageY,n=[t-O.left,a-O.top];return W.unmapArrayCoord(n)};return Object(o.useEffect)((function(){s<20&&m&&p(Y.setShowFpsWarning(!0))}),[s,m,p]),r.a.createElement("div",null,E&&r.a.createElement(Ee,{isOpen:E,setIsOpen:function(e){p(Y.setShowFpsWarning(e))}}),r.a.createElement(Ce,{socket:l,buildActionHandler:h,updateLocationName:v}),r.a.createElement(Ae,null),r.a.createElement("div",{onMouseMove:function(e){if(f&&T&&T.current){var a=D(e);t&&t(a);var o=le.findComponent(a,n,[c]);(d?d.id:d)!==(o?o.id:o)&&p(Y.setHoveredComponent(o))}},onMouseDown:function(e){if(T&&T.current){e.preventDefault();var t=D(e);a&&a(t,e.button),(!u||d&&u.id!==d.id)&&p(Y.setSelectedComponent(d))}},onContextMenu:function(e){return e.preventDefault(),!1},ref:T,style:{cursor:i||(d?"pointer":"move")}},r.a.createElement(oe,null)))})),Pe=a(68);var we=Object(ae.b)((function(e){return{curMode:e.curMode,selectedComponent:e.selectedComponent,hoveredComponent:e.hoveredComponent,curBuildPointerType:e.curBuildPointerType}}))((function(e){var t=e.dispatch,a=e.curMode,n=e.curBuildPointerType,c=(e.selectedComponent,e.hoveredComponent),i=Object(o.useRef)(JSON.parse(localStorage.getItem("saved-map-data"))||Pe),d=Object(o.useRef)(null),p=Object(o.useState)(null),m=Object(u.a)(p,2),E=m[0],f=m[1],O=Object(o.useState)(null),h=Object(u.a)(O,2),T=h[0],D=h[1];Object(o.useEffect)((function(){console.log(a),ee.updateMapData(i.current)}),[a]);var b=function(e){"Escape"===e.key&&(t(Y.setCurBuildPointerType(v.BUILD_POINTER_TYPE.NONE)),d.current=null)};Object(o.useEffect)((function(){return window.addEventListener("keydown",b),function(){window.removeEventListener("keydown",b)}}),[]),Object(o.useEffect)((function(){var e=setInterval((function(){localStorage.setItem("saved-map-data",JSON.stringify(y()))}),5e3);return function(){clearInterval(e)}}),[]);var y=function(){return{id:"map_".concat(W.generateShortUuid()),locations:i.current.locations,intersections:i.current.intersections,vehicles:{},roads:i.current.roads}},I=function(e){if(e&&e.id){var t=JSON.parse(JSON.stringify(i.current));t.intersections[e.id]&&delete t.intersections[e.id],t.locations[e.id]&&delete t.locations[e.id];for(var a=0,n=Object.keys(i.current.roads);a<n.length;a++){var o=n[a];i.current.roads[o].start!==e.id&&i.current.roads[o].end!==e.id||delete t.roads[o]}i.current=t,d.current=null,ee.updateMapData(t)}},_=0;n===v.BUILD_POINTER_TYPE.LOCATION?_=X.DISPLAY.LOCATION_RADIUS:n===v.BUILD_POINTER_TYPE.INTERSECTION&&(_=X.DISPLAY.INTERSECTION_RADIUS);var S=null;n.includes(v.BUILD_POINTER_TYPE.ROAD_SUFFIX)&&E?S="crosshair":n===v.BUILD_POINTER_TYPE.DELETE&&(S="no-drop");var g=function(e){switch(e){case v.BUILD_ACTIONS.ADD_LOCATION:ee.updateMapData(i.current),t(Y.setCurBuildPointerType(v.BUILD_POINTER_TYPE.LOCATION)),d.current=null;break;case v.BUILD_ACTIONS.ADD_INTERSECTION:ee.updateMapData(i.current),t(Y.setCurBuildPointerType(v.BUILD_POINTER_TYPE.INTERSECTION)),d.current=null;break;case v.BUILD_ACTIONS.BUILD_MAJOR_ROAD:ee.updateMapData(i.current),t(Y.setCurBuildPointerType(v.BUILD_POINTER_TYPE.MAJOR_ROAD)),D(X.ROAD_TYPES.TYPES.MAJOR);break;case v.BUILD_ACTIONS.BUILD_MINOR_ROAD:ee.updateMapData(i.current),t(Y.setCurBuildPointerType(v.BUILD_POINTER_TYPE.MINOR_ROAD)),D(X.ROAD_TYPES.TYPES.MINOR);break;case v.BUILD_ACTIONS.BUILD_LOCAL_ROAD:ee.updateMapData(i.current),t(Y.setCurBuildPointerType(v.BUILD_POINTER_TYPE.LOCAL_ROAD)),D(X.ROAD_TYPES.TYPES.LOCAL);break;case v.BUILD_ACTIONS.DELETE_COMPONENTS:ee.updateMapData(i.current),t(Y.setCurBuildPointerType(v.BUILD_POINTER_TYPE.DELETE)),d.current=null;break;case v.BUILD_ACTIONS.RESET_POINTER:f(null),ee.updateMapData(i.current),t(Y.setCurBuildPointerType(v.BUILD_POINTER_TYPE.NONE)),d.current=null;break;case v.BUILD_ACTIONS.SAVE_MAP:!function(){var e=y(),t="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e)),a=document.createElement("a");a.setAttribute("href",t),a.setAttribute("download",e.id+".json"),document.body.appendChild(a),a.click(),a.remove()}()}};return r.a.createElement("div",{className:"mt-1"},r.a.createElement("div",null,r.a.createElement(Le,{onMouseMove:function(e){if(n===v.BUILD_POINTER_TYPE.INTERSECTION){var t=d.current;t&&t.includes("intersection")||(t="intersection_".concat(W.generateShortUuid())),d.current=t;var a=Object(s.a)(Object(s.a)({},ee.mapData),{},{intersections:Object(s.a)(Object(s.a)({},ee.mapData.intersections),{},Object(l.a)({},t,Object(s.a)(Object(s.a)({},ee.mapData.intersections[t]),{},{id:t,coord:e})))});ee.updateMapData(a)}else if(n===v.BUILD_POINTER_TYPE.LOCATION){var o=d.current,r=null,c=!1;o&&o.includes("location")||(o="location_".concat(W.generateShortUuid()),r=X.getUniqueLocationName(),c=!0),d.current=o;var u=Object(s.a)(Object(s.a)({},ee.mapData),{},{locations:Object(s.a)(Object(s.a)({},ee.mapData.locations),{},Object(l.a)({},o,Object(s.a)(Object(s.a)({},ee.mapData.locations[o]),{},{coord:e})))});c&&(u.locations[o].id=o,u.locations[o].name=r),ee.updateMapData(u)}else ee.updateMapData(i.current),d.current=null},onMouseDown:function(e,t){if(0===t)if(n===v.BUILD_POINTER_TYPE.INTERSECTION||n===v.BUILD_POINTER_TYPE.LOCATION)c||(i.current=ee.mapData,d.current=null);else if(n.includes(v.BUILD_POINTER_TYPE.ROAD_SUFFIX)){if(c)if(E){var a="road_".concat(W.generateShortUuid()),o=Object(s.a)(Object(s.a)({},i.current),{},{roads:Object(s.a)(Object(s.a)({},i.current.roads),{},Object(l.a)({},a,{id:a,type:T,start:E,end:c.id}))});i.current=o,ee.updateMapData(o),f(c.id)}else f(c.id)}else n===v.BUILD_POINTER_TYPE.DELETE&&c&&I(c);else 2===t&&g(v.BUILD_ACTIONS.RESET_POINTER)},curPointerRadius:_,curPointerComponentId:d.current,cursorStyle:S,buildActionHandler:g,updateLocationName:function(e,t){ee.mapData.locations[e].name=t,i.current=ee.mapData}})))}));var Re=Object(ae.b)((function(e){return{curMode:e.curMode}}))((function(e){var t,a=e.socket,n=e.curMode;return e.dispatch,Object(o.useEffect)((function(){return ee.init(a),function(){ee.cleanup(a),a.disconnect()}}),[]),n===v.APP_MODE_LIST.VIEW_MAP?t=r.a.createElement(Le,{socket:a}):n===v.APP_MODE_LIST.CREATE_MAP&&(t=r.a.createElement(we,null)),r.a.createElement("div",{className:"App"},t)})),Ne=(a(91),a(69)),Me="http://localhost:3001";Me="https://auto-drive-simulator-api.herokuapp.com/";var je=a.n(Ne)()(Me);i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ae.a,{store:n=Object(O.createStore)(V,Object(x.composeWithDevTools)(Object(O.applyMiddleware)(h.a)))},r.a.createElement(Re,{socket:je}))),document.getElementById("root"))},68:function(e){e.exports=JSON.parse('{"id":"map_8fzBXojVN4DkjwGhs3p3ks","locations":{},"intersections":{"intersection_0":{"id":"intersection_0","coord":[0,0]},"intersection_1":{"id":"intersection_1","coord":[0,1000]}},"vehicles":{},"roads":{"road_0":{"id":"road_0","type":"MAJOR","start":"intersection_0","end":"intersection_1"}}}')},70:function(e,t,a){e.exports=a(124)}},[[70,1,2]]]);
//# sourceMappingURL=main.0c45715d.chunk.js.map