(this["webpackJsonpauto-drive-network-app"]=this["webpackJsonpauto-drive-network-app"]||[]).push([[0],{115:function(e,t){},118:function(e,t,a){"use strict";a.r(t);var n,r=a(0),o=a.n(r),c=a(16),i=a.n(c),l=a(20),s=a(2),d=a(11),u=a(122),p=a(125),m=a(124),f=a(9),v=a(10),h=a(14),E=a(34),y=a.n(E),O=a(19),b=a(60),g={APP_MODE_LIST:{VIEW_MAP:"view_map",CREATE_MAP:"create_map"}},S="UPDATE_MAP_DATA_LOADED",C="UPDATE_AVERAGE_RENDERS_PER_SECOND",T="UPDATE_AVERAGE_UPDATES_PER_SECOND",D="UPDATE_CUR_MODE",w="UPDATE_SELECTED_COMPONENT",P="UPDATE_HOVERED_COMPONENT",A="UPDATE_SHOW_DYNAMIC_LABELS",I="UPDATE_SHOW_STATIC_LABELS",L="UPDATE_SHOW_TOGGLE_DYNAMIC_LABELS",j="UPDATE_SHOW_FPS_WARNING",_="UPDATE_CUR_TRIP_VEHICLE_ID",R="UPDATE_FOLLOW_CUR_TRIP_VEHICLE",k="UPDATE_CANVAS_DIMENSIONS",N="UPDATE_CANVAS_PROPS_BY_DIFF",M="UPDATE_CANVAS_PROPS",U="UPDATE_CANVAS_PROPS_BY_ZOOM_FACTOR",V="UPDATE_CANVAS_OFFSET",x={setFollowCurTripVehicle:function(e){return{type:R,payload:e}},setCanvasOffset:function(e){return{type:V,payload:e}},setCanvasPropsZoom:function(e,t){return{type:U,payload:{zoomOffsetFromViewCentre:t,zoomFactor:e}}},setCanvasPropsDiff:function(e){return{type:N,payload:e}},setCanvasProps:function(e){return{type:M,payload:e}},setCanvasDimensions:function(e){return{type:k,payload:e}},setCurMode:function(e){return{type:D,payload:e}},setSelectedComponent:function(e){return{type:w,payload:e}},setHoveredComponent:function(e){return{type:P,payload:e}},setShowDynamicLabels:function(e){return{type:A,payload:e}},setShowStaticLabels:function(e){return{type:I,payload:e}},setShowToggleDynamicLabels:function(e){return{type:L,payload:e}},setShowFpsWarning:function(e){return{type:j,payload:e}},setCurTripVehicleId:function(e){return{type:_,payload:e}},setMapDataLoaded:function(e){return{type:S,payload:e}},setAverageUpdatesPerSecond:function(e){return{type:T,payload:e}},setAverageRendersPerSecond:function(e){return{type:C,payload:e}}},Y={mapDataLoaded:!1,averageUpdatesPerSecond:Number.POSITIVE_INFINITY,averageRendersPerSecond:Number.POSITIVE_INFINITY,curMode:g.APP_MODE_LIST.VIEW_MAP,selectedComponent:null,hoveredComponent:null,showLabels:{dynamic:!0,static:!0},curTripVehicleId:null,followCurTripVehicle:!1,showToggleDynamicLabels:!0,showLowFpsWarning:!1,shownLowFpsWarning:!1,canvasDimensions:{width:0,height:0},canvasProps:{centerX:0,centerY:0,zoom:.5},canvasOffset:{left:0,top:0}},W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case R:return Object(s.a)(Object(s.a)({},e),{},{followCurTripVehicle:t.payload,canvasProps:Object(s.a)(Object(s.a)({},e.canvasProps),{},{zoom:t.payload?1:e.canvasProps.zoom})});case V:return Object(s.a)(Object(s.a)({},e),{},{canvasOffset:Object(s.a)(Object(s.a)({},e.canvasOffset),t.payload)});case C:return Object(s.a)(Object(s.a)({},e),{},{averageRendersPerSecond:t.payload});case T:return Object(s.a)(Object(s.a)({},e),{},{averageUpdatesPerSecond:t.payload});case S:return Object(s.a)(Object(s.a)({},e),{},{mapDataLoaded:t.payload});case U:var a=t.payload,n=a.zoomOffsetFromViewCentre,r=a.zoomFactor,o={x:n.x+e.canvasProps.centerX,y:n.y+e.canvasProps.centerY};return Object(s.a)(Object(s.a)({},e),{},{canvasProps:{centerX:e.canvasProps.centerX-o.x*(1-r),centerY:e.canvasProps.centerY-o.y*(1-r),zoom:e.canvasProps.zoom*r}});case N:return Object(s.a)(Object(s.a)({},e),{},{canvasProps:{centerX:t.payload.centerX?e.canvasProps.centerX+t.payload.centerX:e.canvasProps.centerX,centerY:t.payload.centerY?e.canvasProps.centerY+t.payload.centerY:e.canvasProps.centerY,zoom:t.payload.zoom?e.canvasProps.zoom*t.payload.zoom:e.canvasProps.zoom}});case M:return Object(s.a)(Object(s.a)({},e),{},{canvasProps:Object(s.a)(Object(s.a)({},e.canvasProps),t.payload)});case k:return Object(s.a)(Object(s.a)({},e),{},{canvasDimensions:Object(s.a)(Object(s.a)({},e.canvasDimensions),t.payload)});case D:return Object(s.a)(Object(s.a)({},e),{},{curMode:t.payload});case w:return Object(s.a)(Object(s.a)({},e),{},{selectedComponent:t.payload});case P:return Object(s.a)(Object(s.a)({},e),{},{hoveredComponent:t.payload});case A:return Object(s.a)(Object(s.a)({},e),{},{showLabels:Object(s.a)(Object(s.a)({},e.showLabels),{},{dynamic:t.payload})});case I:return Object(s.a)(Object(s.a)({},e),{},{showLabels:Object(s.a)(Object(s.a)({},e.showLabels),{},{static:t.payload})});case L:return Object(s.a)(Object(s.a)({},e),{},{showToggleDynamicLabels:t.payload});case j:return t.payload&&!e.shownLowFpsWarning?Object(s.a)(Object(s.a)({},e),{},{showLowFpsWarning:!0,shownLowFpsWarning:!0}):Object(s.a)(Object(s.a)({},e),{},{showLowFpsWarning:!1});case _:return Object(s.a)(Object(s.a)({},e),{},{curTripVehicleId:t.payload});default:return e}},F=a(61);function z(){return n}var H=function(){function e(){Object(f.a)(this,e)}return Object(v.a)(e,null,[{key:"generateShortUuid",value:function(){return this.shortUuidGenerator.generate()}},{key:"getCanvasViewCutoffs",value:function(){var e=z().getState().canvasDimensions;return{left:0,right:e.width,top:0,bottom:e.height}}},{key:"checkCoordinateInCanvasView",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=this.getCanvasViewCutoffs(),n=e[0]+t/2>=a.left,r=e[0]-t/2<=a.right,o=e[1]+t/2>=a.top,c=e[1]-t/2<=a.bottom;return n&&r&&o&&c}},{key:"getCoordFromWaypoint",value:function(e,t){return e.startsWith("intersection")?t.intersections[e].coord:e.startsWith("location")?t.locations[e].coord:null}},{key:"getDistanceBetweenArrayCoords",value:function(e,t){for(var a=0,n=0;n<e.length;n++)a+=Math.pow(t[n]-e[n],2);return Math.sqrt(a)}},{key:"mapArrayCoord",value:function(t){return t?t.map(e.mapSingleCoord):null}},{key:"unmapArrayCoord",value:function(t){return t?t.map(e.unmapSingleCoord):null}},{key:"scaleSingleCoord",value:function(e){return e*z().getState().canvasProps.zoom}},{key:"unscaleSingleCoord",value:function(e){return e/z().getState().canvasProps.zoom}},{key:"mapSingleCoord",value:function(t,a){var n=e.scaleSingleCoord(t),r=z().getState(),o=r.canvasDimensions,c=r.canvasProps;return 0===a?n+=o.width/2-c.centerX:1===a&&(n+=o.height/2-c.centerY),n}},{key:"unmapSingleCoord",value:function(t,a){var n=t,r=z().getState(),o=r.canvasDimensions,c=r.canvasProps;return 0===a?n-=o.width/2-c.centerX:1===a&&(n-=o.height/2-c.centerY),e.unscaleSingleCoord(n)}}]),e}();H.shortUuidGenerator=y()(y.a.constants.flickrBase58);var X={ROAD_DRIVING_SIDE:{LEFT:"left",RIGHT:"right"},VEHICLE_STATE:{SPAWNED:"spawned",DEPARTURE_READY:"departure_ready",EN_ROUTE:"en_route",ARRIVED:"arrived"},ROAD_TYPES:{TYPES:{LOCAL:"LOCAL",MINOR:"MINOR",MAJOR:"MAJOR"},WIDTH:{LOCAL:50,MINOR:60,MAJOR:100}},VEHICLE_DIRECTION:{TOWARDS_START:"towards_start",TOWARDS_END:"towards_end"},DISPLAY:{INTERSECTION_RADIUS:45,LOCATION_RADIUS:30,VEHICLE_RADIUS:10}},J=X,B=function(){function e(){Object(f.a)(this,e)}return Object(v.a)(e,null,[{key:"render",value:function(e,t,a){var n=function(a){Object.entries(t.roads).forEach((function(n){n[0];var r=n[1],o=H.mapArrayCoord(H.getCoordFromWaypoint(r.start,t)),c=H.mapArrayCoord(H.getCoordFromWaypoint(r.end,t));if(o&&c)if("pavement"===a)r.type===J.ROAD_TYPES.TYPES.LOCAL?e.lineWidth=H.scaleSingleCoord(J.ROAD_TYPES.WIDTH.LOCAL):r.type===J.ROAD_TYPES.TYPES.MINOR?e.lineWidth=H.scaleSingleCoord(J.ROAD_TYPES.WIDTH.MINOR):r.type===J.ROAD_TYPES.TYPES.MAJOR&&(e.lineWidth=H.scaleSingleCoord(J.ROAD_TYPES.WIDTH.MAJOR)),e.strokeStyle="black",e.lineJoin="round",e.setLineDash([]),e.beginPath(),e.moveTo.apply(e,Object(h.a)(o)),e.lineTo.apply(e,Object(h.a)(c)),e.stroke();else if("center-line"===a){if(e.lineWidth=H.scaleSingleCoord(1),e.strokeStyle="yellow",r.type===J.ROAD_TYPES.TYPES.LOCAL)e.setLineDash([H.scaleSingleCoord(5),H.scaleSingleCoord(5)]),e.beginPath(),e.moveTo.apply(e,Object(h.a)(o)),e.lineTo.apply(e,Object(h.a)(c)),e.stroke();else if(r.type===J.ROAD_TYPES.TYPES.MINOR)e.setLineDash([]),e.beginPath(),e.moveTo.apply(e,Object(h.a)(o)),e.lineTo.apply(e,Object(h.a)(c)),e.stroke();else if(r.type===J.ROAD_TYPES.TYPES.MAJOR){e.setLineDash([]),e.beginPath(),e.moveTo.apply(e,Object(h.a)(o)),e.lineTo.apply(e,Object(h.a)(c)),e.stroke();var i={x:c[0]-o[0],y:c[1]-o[1]},l={x:-i.y/Math.sqrt(Math.pow(i.x,2)+Math.pow(i.y,2)),y:i.x/Math.sqrt(Math.pow(i.x,2)+Math.pow(i.y,2))};e.strokeStyle="white",e.setLineDash([H.scaleSingleCoord(3),H.scaleSingleCoord(5)]),e.beginPath(),e.moveTo(o[0]+H.scaleSingleCoord(25*l.x),o[1]+H.scaleSingleCoord(25*l.y)),e.lineTo(c[0]+H.scaleSingleCoord(25*l.x),c[1]+H.scaleSingleCoord(25*l.y)),e.stroke(),e.beginPath(),e.moveTo(o[0]-H.scaleSingleCoord(25*l.x),o[1]-H.scaleSingleCoord(25*l.y)),e.lineTo(c[0]-H.scaleSingleCoord(25*l.x),c[1]-H.scaleSingleCoord(25*l.y)),e.stroke()}e.lineJoin="round"}}))};n("pavement"),n("center-line")}}]),e}(),G=function(){function e(){Object(f.a)(this,e)}return Object(v.a)(e,null,[{key:"render",value:function(e,t,a){Object.entries(t.locations).forEach((function(t){var n=t[0],r=t[1],o=H.mapArrayCoord(r.coord);H.checkCoordinateInCanvasView(o,J.DISPLAY.LOCATION_RADIUS)&&(e.lineWidth=2,e.strokeStyle="grey",e.fillStyle="#ff0000",e.setLineDash([]),e.beginPath(),e.arc(o[0],o[1],H.scaleSingleCoord(J.DISPLAY.LOCATION_RADIUS),0,2*Math.PI),e.stroke(),e.fill(),a&&(e.font=H.scaleSingleCoord(50)+"px Arial",e.strokeStyle="white",e.strokeWidth=H.scaleSingleCoord(2),e.strokeText(n,o[0],o[1]),e.fillStyle="black",e.fillText(n,o[0],o[1])))}))}}]),e}(),q=function(){function e(){Object(f.a)(this,e)}return Object(v.a)(e,null,[{key:"render",value:function(e,t,a){Object.entries(t.intersections).forEach((function(t){var n=t[0],r=t[1],o=H.mapArrayCoord(r.coord);H.checkCoordinateInCanvasView(o,J.DISPLAY.INTERSECTION_RADIUS)&&(e.lineWidth=2,e.strokeStyle="grey",e.fillStyle="#00ff00",e.setLineDash([]),e.beginPath(),e.arc(o[0],o[1],H.scaleSingleCoord(J.DISPLAY.INTERSECTION_RADIUS),0,2*Math.PI),e.stroke(),e.fill(),a&&(e.font=H.scaleSingleCoord(50)+"px Arial",e.strokeStyle="white",e.strokeWidth=H.scaleSingleCoord(2),e.strokeText(n,o[0],o[1]),e.fillStyle="black",e.fillText(n,o[0],o[1])))}))}}]),e}(),Z=function(){function e(){Object(f.a)(this,e)}return Object(v.a)(e,null,[{key:"render",value:function(e,t,a,n){Object.entries(t.vehicles).forEach((function(t){var r=t[0],o=t[1],c=H.mapArrayCoord(o.coord);if(H.checkCoordinateInCanvasView(c,J.DISPLAY.VEHICLE_RADIUS)&&(e.lineWidth=2,e.strokeStyle="grey",e.fillStyle=n===r?"purple":"blue",e.setLineDash([]),e.beginPath(),e.arc(c[0],c[1],H.scaleSingleCoord(J.DISPLAY.VEHICLE_RADIUS),0,2*Math.PI),e.stroke(),e.fill(),a||n===r)){e.lineJoin="round",e.miterLimit=2;var i="".concat(r," | Src: ").concat(o.originId," | Dest: ").concat(o.destinationId);e.font=H.scaleSingleCoord(15)+"px Arial",e.strokeStyle="black",e.strokeWidth=H.scaleSingleCoord(1),e.strokeText(i,c[0],c[1]),e.fillStyle="yellow",e.fillText(i,c[0],c[1])}}))}}]),e}(),K={mapData:null,lastUpdateTimeElapsedList:[]};K.lastUpdateTime=performance.now(),K.lastReduxUpdateTime=performance.now();var Q=function(e){var t=!!K.mapData;if(K.mapData=e,t||z().dispatch(x.setMapDataLoaded(!0)),z().getState().followCurTripVehicle){var a=z().getState().curTripVehicleId;if(console.log(a),K.mapData.vehicles[a]){var n=K.mapData.vehicles[a].coord;z().dispatch(x.setCanvasProps({centerX:H.scaleSingleCoord(n[0]),centerY:H.scaleSingleCoord(n[1])}))}else z().dispatch(x.setFollowCurTripVehicle(!1)),z().dispatch(x.setCurTripVehicleId(null))}var r=performance.now(),o=r-K.lastUpdateTime;if(K.lastUpdateTimeElapsedList.push(o),K.lastUpdateTimeElapsedList.length>100&&K.lastUpdateTimeElapsedList.shift(),r-K.lastReduxUpdateTime>1e3){var c=1e3/(K.lastUpdateTimeElapsedList.reduce((function(e,t){return e+t}),0)/K.lastUpdateTimeElapsedList.length);K.lastUpdateTimeElapsedList.length<100&&(c=Number.POSITIVE_INFINITY),z().dispatch(x.setAverageUpdatesPerSecond(c)),K.lastReduxUpdateTime=r}K.lastUpdateTime=r};K.init=function(e){e.on("update-map-data",Q)},K.cleanup=function(e){e.off("update-map-data",Q)};var $=K,ee=function(){function e(){Object(f.a)(this,e)}return Object(v.a)(e,null,[{key:"getMapData",value:function(){return $.mapData}},{key:"getShowLabels",value:function(){var e=z().getState(),t=e.showToggleDynamicLabels,a=e.followCurTripVehicle,n=e.showLabels.dynamic;return t&&n&&!a}},{key:"getCurTripVehicleId",value:function(){return z().getState().curTripVehicleId}},{key:"_renderStatic",value:function(e){var t=this.getMapData(),a=this.getShowLabels(),n=z().getState().canvasDimensions,r=n.width,o=n.height;if(t&&e){var c=e.getContext("2d");c.clearRect(0,0,r,o),c.fillStyle="#dddddd",c.fillRect(0,0,r,o);var i=new Image;i.src="/logo192.png",i.onload=function(){c.drawImage(i,0,0,50,50)},B.render(c,t,a),G.render(c,t,a),q.render(c,t,a)}}},{key:"_renderDynamic",value:function(e){var t=this.getMapData(),a=this.getShowLabels(),n=z().getState().canvasDimensions,r=n.width,o=n.height;if(t&&e){var c=e.getContext("2d");c.clearRect(0,0,r,o),Z.render(c,t,a,this.getCurTripVehicleId())}}},{key:"renderAll",value:function(e,t){this._renderStatic(e),this._renderDynamic(t);var a=performance.now(),n=a-this.lastRenderTime;if(this.lastRenderTimeElapsedList.push(n),this.lastRenderTimeElapsedList.length>100&&this.lastRenderTimeElapsedList.shift(),a-this.lastReduxUpdateTime>1e3){var r=1e3/(this.lastRenderTimeElapsedList.reduce((function(e,t){return e+t}),0)/this.lastRenderTimeElapsedList.length);this.lastRenderTimeElapsedList.length<100&&(r=Number.POSITIVE_INFINITY),z().dispatch(x.setAverageRendersPerSecond(r)),this.lastReduxUpdateTime=a}this.lastRenderTime=a}}]),e}();ee.lastRenderTimeElapsedList=[],ee.lastRenderTime=performance.now(),ee.lastReduxUpdateTime=performance.now();var te=a(7);var ae=Object(te.b)((function(e){return{curMode:e.curMode,mapLoaded:e.mapDataLoaded,showDynamicLabels:e.showLabels.dynamic,showToggleDynamicLabels:e.showToggleDynamicLabels,canvasProps:e.canvasProps,canvasDimensions:e.canvasDimensions,followCurTripVehicle:e.followCurTripVehicle}}))((function(e){var t=e.showToggleDynamicLabels,a=e.dispatch,n=e.canvasProps,c=e.canvasDimensions,i=e.mapLoaded,l=e.followCurTripVehicle,s=Object(r.useRef)(null),d=Object(r.useRef)(null),u=Object(r.useRef)(null);Object(r.useEffect)((function(){a(x.setCanvasDimensions({height:window.innerHeight,width:window.innerWidth})),a(x.setCanvasProps({centerX:0,centerY:0,zoom:.5}))}),[a]);var p=Object(r.useRef)(!1),m=Object(r.useRef)(null);Object(r.useEffect)((function(){var e=function(e){var t=0,n=0;switch(e.key){case"ArrowUp":n=50;break;case"ArrowDown":n=-50;break;case"ArrowLeft":t=50;break;case"ArrowRight":t=-50}a(x.setCanvasPropsDiff({centerX:t,centerY:n,zoom:1}))};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}),[a]);var f=Object(r.useCallback)((function(e){if(e.preventDefault(),e.stopPropagation(),i){var t=e.pageX,n=e.pageY,r=e.deltaY,o=1;if(r>0?o=.8:r<0&&(o=1.25),l)a(x.setCanvasPropsZoom(o,{x:0,y:0}));else{var d={x:t-s.current.offsetLeft,y:n-s.current.offsetTop},u={x:d.x-c.width/2,y:d.y-c.height/2};a(x.setCanvasPropsZoom(o,u))}}return!1}),[c,a,i,l]);Object(r.useEffect)((function(){if(u.current){a(x.setCanvasOffset({left:u.current.offsetLeft,top:u.current.offsetTop}));var e=u.current;return e.addEventListener("wheel",f,{passive:!1}),function(){e.removeEventListener("wheel",f)}}}),[u,i,a,f]),Object(r.useEffect)((function(){window.requestAnimationFrame((function e(){ee.renderAll(s.current,d.current),window.requestAnimationFrame(e)}))}),[]);var v=function(e){p.current=!1,m.current=null},h=Object(r.useRef)(null);return Object(r.useEffect)((function(){n.zoom<.4?t&&a(x.setShowToggleDynamicLabels(!1)):t||a(x.setShowToggleDynamicLabels(!0))}),[n.zoom,t,a]),o.a.createElement("div",{onMouseDown:function(e){e.preventDefault(),i&&!l&&(p.current=!0,m.current={x:e.screenX,y:e.screenY})},onMouseUp:v,onMouseLeave:v,onMouseMove:function(e){var t=performance.now();if(p.current&&(!h.current||t-h.current>1e3/30)){h.current=t;var n={x:m.current.x,y:m.current.y},r={x:e.screenX,y:e.screenY};a(x.setCanvasPropsDiff({zoom:1,centerX:-(r.x-n.x),centerY:-(r.y-n.y)})),m.current=r}},ref:u,style:{height:c.height,width:c.width,position:"absolute",top:0,left:0,zIndex:-1}},i?o.a.createElement("div",null,o.a.createElement("canvas",{style:{position:"absolute",zIndex:2},ref:d,height:c.height,width:c.width}),o.a.createElement("canvas",{style:{position:"absolute",zIndex:1},ref:s,height:c.height,width:c.width})):o.a.createElement("div",null,"Loading map data..."))})),ne={},re=function(e,t,a,n){for(var r=0,o=Object.entries(t.intersections);r<o.length;r++){var c=o[r];if(!n.includes(c[0])){var i=c[1];if(H.getDistanceBetweenArrayCoords(i.coord,e)<J.DISPLAY.INTERSECTION_RADIUS+a)return{type:"intersection",id:c[0],data:c[1]}}}return null},oe=function(e,t,a,n){for(var r=0,o=Object.entries(t.locations);r<o.length;r++){var c=o[r];if(!n.includes(c[0])){var i=c[1];if(H.getDistanceBetweenArrayCoords(i.coord,e)<J.DISPLAY.LOCATION_RADIUS+a)return{type:"location",id:c[0],data:c[1]}}}return null};ne.findComponent=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=$.mapData,r=[re,oe],o=0,c=r;o<c.length;o++){var i=c[o],l=i(e,n,t,a);if(l)return l}};var ce=ne,ie=a(126),le=a(119),se=a(120),de=a(121);function ue(e){var t=e.isOpen,a=e.setIsOpen,n=e.className;return o.a.createElement(ie.a,{isOpen:t,toggle:function(){a(!t)},className:n},o.a.createElement(le.a,{toggle:function(){a(!t)}},"Low FPS Detected"),o.a.createElement(se.a,null,"It has been detected at the map is running at a lower than optimal frame rate. It may help to hide the labels by toggling the ",o.a.createElement("code",null,"Toggle Labels")," checkbox"),o.a.createElement(de.a,null,o.a.createElement(u.a,{color:"primary",onClick:function(){a(!t)}},"OK")))}var pe=a(38);function me(e){var t,a=e.sectionName,n=e.children,c=e.openInitial,i=void 0===c||c,l=Object(r.useState)(i),s=Object(d.a)(l,2),u=s[0],p=s[1];return t=u?pe.a:pe.b,o.a.createElement("div",{className:"mx-2 my-2"},o.a.createElement("div",{className:"font-weight-bold",style:{display:"flex",justifyContent:"space-between",alignContent:"center",alignItems:"center"}},a,o.a.createElement("div",{style:{cursor:"pointer"},onClick:function(){p((function(e){return!e}))}},o.a.createElement(t,null))),u&&o.a.createElement("div",null,n),o.a.createElement("hr",{className:"mb-0"}))}var fe=Object(te.b)((function(e){return{selectedComponent:e.selectedComponent,hoveredComponent:e.hoveredComponent}}))((function(e){var t,a=e.hoveredComponent,n=e.selectedComponent,r=a||n;return t=r?o.a.createElement("div",null,o.a.createElement("div",null,"Type: ",r.type),o.a.createElement("div",null,"ID: ",r.id),o.a.createElement("div",null,"Coord: [",r.data.coord[0].toFixed(3),","," ",r.data.coord[1].toFixed(3),"]")):o.a.createElement("div",null,"No component selected"),o.a.createElement("div",{style:{fontSize:12}},t)})),ve=a(123);var he=Object(te.b)((function(e){return{mapDataLoaded:e.mapDataLoaded,curTripVehicleId:e.curTripVehicleId,followCurTripVehicle:e.followCurTripVehicle}}))((function(e){var t=e.curTripVehicleId,a=e.mapDataLoaded,n=e.socket,c=e.followCurTripVehicle,i=e.dispatch,l=Object(r.useState)(null),s=Object(d.a)(l,2),p=s[0],f=s[1];Object(r.useEffect)((function(){if(n){var e=function(e){e&&(f(e),i(x.setCurTripVehicleId(e.id)),i(x.setFollowCurTripVehicle(!0)))};return n.on("start-trip-res",e),function(){n.off("start-trip-res",e)}}}),[n,i]);var v=a?Object.values($.mapData.locations):[];v.sort((function(e,t){return e.id<t.id?-1:e.id>t.id?1:0})),console.log(v);var h,E={fontSize:10};return h=t&&p?o.a.createElement("div",{style:{fontSize:12}},o.a.createElement("div",null,o.a.createElement("span",{className:"font-weight-bold"},"Vehicle ID: "),t),o.a.createElement("div",null,o.a.createElement("span",{className:"font-weight-bold"},"Origin: "),p.originId),o.a.createElement("div",null,o.a.createElement("span",{className:"font-weight-bold"},"Destination: "),p.destinationId),o.a.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",alignContent:"center"},className:"my-1"},o.a.createElement("input",{type:"checkbox",id:"follow-cur-trip-chkbox",className:"mr-1",checked:c,onChange:function(e){var t=e.target.checked;i(x.setFollowCurTripVehicle(t))}}),o.a.createElement("label",{htmlFor:"follow-cur-trip-chkbox",className:"m-0",style:{userSelect:"none",fontSize:10}},"Toggle Follow Current Trip Vehicle"))):o.a.createElement("div",{style:{fontSize:10}},o.a.createElement("div",null,o.a.createElement(ve.a,{for:"navigate-origin",className:"font-weight-bold mb-1 mt-2"},"Origin"),o.a.createElement(m.a,{style:E,type:"select",name:"select",id:"navigate-origin"},v.map((function(e){return o.a.createElement("option",{key:e.id,style:E},e.id)})))),o.a.createElement("div",null,o.a.createElement(ve.a,{for:"navigate-dest",className:"font-weight-bold mb-1 mt-2"},"Destination"),o.a.createElement(m.a,{style:E,type:"select",name:"select",id:"navigate-dest"},v.map((function(e){return o.a.createElement("option",{key:e.id,style:E},e.id)})))),o.a.createElement(u.a,{className:"mt-2",color:"primary",style:{fontSize:10},onClick:function(){var e,t;e=document.getElementById("navigate-origin").value,t=document.getElementById("navigate-dest").value,n&&n.emit("start-trip",{originId:e,destinationId:t})}},"Navigate")),o.a.createElement("div",null,o.a.createElement("div",{className:"mb-1"},t?"Trip Progress":"Start a Trip"),h)}));var Ee=Object(te.b)((function(e){return{showToggleDynamicLabels:e.showToggleDynamicLabels,curMode:e.curMode,showDynamicLabels:e.showLabels.dynamic,followCurTripVehicle:e.followCurTripVehicle}}))((function(e){var t=e.curMode,a=e.showToggleDynamicLabels,n=e.showDynamicLabels,r=e.followCurTripVehicle,c=e.dispatch;return o.a.createElement("div",null,a&&!r&&o.a.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",alignContent:"center"},className:"my-1"},o.a.createElement("input",{type:"checkbox",id:"show-labels-chkbox",className:"mr-1",checked:n,onChange:function(e){var t=e.target.checked;c(x.setShowDynamicLabels(t))}}),o.a.createElement("label",{htmlFor:"show-labels-chkbox",className:"m-0",style:{userSelect:"none",fontSize:10}},"Toggle Vehicle Labels")),o.a.createElement("div",null,o.a.createElement(u.a,{color:"link",style:{fontSize:10,padding:0},onClick:function(){t===g.APP_MODE_LIST.CREATE_MAP?c(x.setCurMode(g.APP_MODE_LIST.VIEW_MAP)):c(x.setCurMode(g.APP_MODE_LIST.CREATE_MAP))}},t===g.APP_MODE_LIST.CREATE_MAP?"Switch to View Mode":"Switch to Create Mode")))}));var ye=Object(te.b)((function(e){return{averageUpdatesPerSecond:e.averageUpdatesPerSecond,averageRendersPerSecond:e.averageRendersPerSecond,mapDataLoaded:e.mapDataLoaded}}))((function(e){var t,a=e.mapDataLoaded,n=e.averageUpdatesPerSecond,r=e.averageRendersPerSecond,c={};if(a){var i=$.mapData;t=o.a.createElement("div",null,o.a.createElement("div",{style:c},"Map ID: ",i.id),o.a.createElement("div",{style:c},"Total Vehicles: ",Object.keys(i.vehicles).length),o.a.createElement("div",{style:c},"Total Intersections:"," ",Object.keys(i.intersections).length),o.a.createElement("div",{style:c},"Total Locations: ",Object.keys(i.locations).length),o.a.createElement("div",{style:c},"Total Roads: ",Object.keys(i.roads).length),o.a.createElement("div",{style:c},"Avg Updates/Sec: ",n.toFixed(2)),o.a.createElement("div",{style:c},"Avg Renders/Sec: ",r.toFixed(2)))}else t=o.a.createElement("div",null,"Map data not loaded.");return o.a.createElement("div",{style:{fontSize:12}},t)}));var Oe=Object(te.b)((function(e){return{}}))((function(e){var t=e.socket;return o.a.createElement("div",{style:{background:"#ffffffcc",margin:10,display:"flex",flexDirection:"column",flexWrap:"wrap",justifyContent:"space-between",width:300,position:"fixed",borderRadius:5}},o.a.createElement(me,{sectionName:"Selected Component"},o.a.createElement(fe,null)),o.a.createElement(me,{sectionName:"Navigator"},o.a.createElement(he,{socket:t})),o.a.createElement(me,{sectionName:"Map Stats"},o.a.createElement(ye,null)),o.a.createElement(me,{sectionName:"Menu Settings"},o.a.createElement(Ee,null)))}));var be=Object(te.b)((function(e){return{mapDataLoaded:e.mapDataLoaded,averageUpdatesPerSecond:e.averageUpdatesPerSecond,selectedComponent:e.selectedComponent,hoveredComponent:e.hoveredComponent,showDynamicLabels:e.showLabels.dynamic,showLowFpsWarning:e.showLowFpsWarning,canvasOffset:e.canvasOffset}}))((function(e){var t=e.onMouseMove,a=e.onMouseDown,n=e.curPointerRadius,c=e.curPointerComponentId,i=e.cursorStyle,l=e.socket,s=e.averageUpdatesPerSecond,d=e.selectedComponent,u=e.hoveredComponent,p=e.dispatch,m=e.showDynamicLabels,f=e.showLowFpsWarning,v=e.mapDataLoaded,h=e.canvasOffset,E=Object(r.useRef)(null),y=function(e){var t=e.pageX,a=e.pageY,n=[t-h.left,a-h.top];return H.unmapArrayCoord(n)};return Object(r.useEffect)((function(){s<20&&m&&p(x.setShowFpsWarning(!0))}),[s,m,p]),o.a.createElement("div",null,f&&o.a.createElement(ue,{isOpen:f,setIsOpen:function(e){p(x.setShowFpsWarning(e))}}),o.a.createElement(Oe,{socket:l}),o.a.createElement("div",{onMouseMove:function(e){if(v&&E&&E.current){var a=y(e);t&&t(a);var r=ce.findComponent(a,n,[c]);(u?u.id:u)!==(r?r.id:r)&&p(x.setHoveredComponent(r))}},onMouseDown:function(e){if(E&&E.current){var t=y(e);a&&a(t),(!d||u&&d.id!==u.id)&&p(x.setSelectedComponent(u))}},ref:E,style:{cursor:i||(u?"pointer":"move")}},o.a.createElement(ae,null)))})),ge=a(37),Se="intersection",Ce="location",Te="none",De="road",we="save_map",Pe="delete";var Ae=Object(te.b)((function(e){return{curState:e.curState}}))((function(){var e=Object(r.useRef)(JSON.parse(localStorage.getItem("saved-map-data"))||ge),t=Object(r.useRef)(null),a=Object(r.useState)(null),n=Object(d.a)(a,2),c=n[0],i=n[1],f=Object(r.useState)(null),v=Object(d.a)(f,2),h=v[0],E=v[1],y=Object(r.useState)(null),O=Object(d.a)(y,2),b=O[0],g=O[1],S=Object(r.useState)(null),C=Object(d.a)(S,2),T=(C[0],C[1]),D=Object(r.useState)(ge),w=Object(d.a)(D,2),P=w[0],A=w[1],I=Object(r.useState)(Te),L=Object(d.a)(I,2),j=L[0],_=L[1],R=Object(r.useState)(""),k=Object(d.a)(R,2),N=k[0],M=k[1],U=function(e){"Escape"===e.key&&(_(Te),t.current=null)};Object(r.useEffect)((function(){return window.addEventListener("keydown",U),function(){window.removeEventListener("keydown",U)}}),[]);var V=Object(r.useRef)(performance.now());Object(r.useEffect)((function(){var e=performance.now();e-V.current>5e3&&(localStorage.setItem("saved-map-data",x()),V.current=e)}),[P]);var x=function(){var t={id:"map_".concat(H.generateShortUuid()),locations:e.current.locations,intersections:e.current.intersections,vehicles:{},roads:e.current.roads};return JSON.stringify(t)},Y=function(a){if(a&&a.id){var n=JSON.parse(JSON.stringify(e.current));n.intersections[a.id]&&delete n.intersections[a.id],n.locations[a.id]&&delete n.locations[a.id];for(var r=0,o=Object.keys(e.current.roads);r<o.length;r++){var c=o[r];e.current.roads[c].start!==a.id&&e.current.roads[c].end!==a.id||delete n.roads[c]}e.current=n,t.current=null,A(n)}},W=0;j===Ce?W=J.DISPLAY.LOCATION_RADIUS:j===Se&&(W=J.DISPLAY.INTERSECTION_RADIUS);var F=null;return j===De&&c?F="crosshair":j===Pe&&(F="no-drop"),o.a.createElement("div",{className:"mt-1"},o.a.createElement("div",null,o.a.createElement(u.a,{color:"primary",className:"m-1",onClick:function(){A(e.current),_(Ce),t.current=null}},"Add Location"),o.a.createElement(u.a,{color:"primary",onClick:function(){A(e.current),_(Se),t.current=null},className:"m-1"},"Add Intersection"),o.a.createElement(u.a,{color:"primary",onClick:function(){A(e.current),_(De),E(J.ROAD_TYPES.TYPES.MAJOR)},className:"m-1"},"Build Major Road"),o.a.createElement(u.a,{color:"primary",onClick:function(){A(e.current),_(De),E(J.ROAD_TYPES.TYPES.MINOR)},className:"m-1"},"Build Minor Road"),o.a.createElement(u.a,{color:"primary",onClick:function(){A(e.current),_(De),E(J.ROAD_TYPES.TYPES.LOCAL)},className:"m-1"},"Build Local Road"),o.a.createElement(u.a,{color:"primary",onClick:function(){A(e.current),_(Pe),t.current=null},className:"m-1"},"Delete Components"),o.a.createElement(u.a,{color:"primary",onClick:function(){i(null),A(e.current),_(Te),t.current=null},className:"m-1"},"Reset Pointer"),o.a.createElement(u.a,{color:"success",onClick:function(){_(we),M(x())},className:"m-1"},"Save Map")),j===we&&o.a.createElement(p.a,{className:"mt-2"},o.a.createElement("div",{className:"mb-2"},"Copy the map data below to your clipboard."),o.a.createElement(m.a,{type:"text",value:N,readOnly:!0})),o.a.createElement("div",null,o.a.createElement(be,{mapData:P,onMouseMove:function(a){j===Se?A((function(e){var n=t.current;return n&&n.includes("intersection")||(n="intersection_".concat(H.generateShortUuid())),t.current=n,Object(s.a)(Object(s.a)({},e),{},{intersections:Object(s.a)(Object(s.a)({},e.intersections),{},Object(l.a)({},n,{id:n,coord:a}))})})):j===Ce?A((function(e){var n=t.current;return n&&n.includes("location")||(n="location_".concat(H.generateShortUuid())),t.current=n,Object(s.a)(Object(s.a)({},e),{},{locations:Object(s.a)(Object(s.a)({},e.locations),{},Object(l.a)({},n,{id:n,coord:a}))})})):(A(e.current),t.current=null)},onMouseDown:function(a){if(j===Se||j===Ce)b||(e.current=P,t.current=null);else if(j===De){if(b)if(c){var n="road_".concat(H.generateShortUuid()),r=Object(s.a)(Object(s.a)({},e.current),{},{roads:Object(s.a)(Object(s.a)({},e.current.roads),{},Object(l.a)({},n,{id:n,type:h,start:c,end:b.id}))});e.current=r,A(r),i(b.id)}else i(b.id)}else j===Pe&&b&&Y(b)},onHoverComponentChanged:function(e){g(e)},onSelectComponentChange:function(e){T(e)},curPointerRadius:W,curPointerComponentId:t.current,cursorStyle:F})))}));var Ie=Object(te.b)((function(e){return{curMode:e.curMode}}))((function(e){var t,a=e.socket,n=e.curMode;return e.dispatch,Object(r.useEffect)((function(){return $.init(a),function(){$.cleanup(a),a.disconnect()}}),[]),n===g.APP_MODE_LIST.VIEW_MAP?t=o.a.createElement(be,{socket:a}):n===g.APP_MODE_LIST.CREATE_MAP&&(t=o.a.createElement(Ae,null)),o.a.createElement("div",{className:"App"},t)})),Le=(a(85),a(63)),je="http://localhost:3001";je="https://auto-drive-simulator-api.herokuapp.com/";var _e=a.n(Le)()(je);i.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(te.a,{store:n=Object(O.createStore)(W,Object(F.composeWithDevTools)(Object(O.applyMiddleware)(b.a)))},o.a.createElement(Ie,{socket:_e}))),document.getElementById("root"))},37:function(e){e.exports=JSON.parse('{"id":"map_8fzBXojVN4DkjwGhs3p3ks","locations":{},"intersections":{"intersection_0":{"id":"intersection_0","coord":[0,0]},"intersection_1":{"id":"intersection_1","coord":[0,1000]}},"vehicles":{},"roads":{"road_0":{"id":"road_0","type":"MAJOR","start":"intersection_0","end":"intersection_1"}}}')},64:function(e,t,a){e.exports=a(118)}},[[64,1,2]]]);
//# sourceMappingURL=main.5eec3d9b.chunk.js.map